import{r as f,_ as q,R as N,b as L,c as P,P as S,u as B,a as T,j as e}from"./index-BxeYf06N.js";import{u as W,c as $}from"./index.esm-BpJkeHwm.js";import{a as p,S as l}from"./sweetalert2.esm.all-CYPmnruj.js";import{b as D,a as I}from"./index.esm-CJR-izqj.js";import{C as A,a as H}from"./CCardBody-9-TyJ2V3.js";import{C as O}from"./CCardHeader-DIYaTK_F.js";import{C as G}from"./CForm-Bau54mqM.js";import{C as y,a as m}from"./CRow-B_r9SPmL.js";import{b as w,C as J}from"./CFormInput-Diq7Y-91.js";import{c as K}from"./cil-save-CHBg7z_U.js";var F=f.forwardRef(function(a,d){var r,v=a.children,b=a.className,c=a.feedback,x=a.feedbackInvalid,o=a.feedbackValid,k=a.floatingClassName,g=a.floatingLabel,j=a.htmlSize,n=a.id,h=a.invalid,C=a.label,u=a.options,s=a.size,i=a.text,R=a.tooltipFeedback,E=a.valid,z=q(a,["children","className","feedback","feedbackInvalid","feedbackValid","floatingClassName","floatingLabel","htmlSize","id","invalid","label","options","size","text","tooltipFeedback","valid"]);return N.createElement(w,{describedby:z["aria-describedby"],feedback:c,feedbackInvalid:x,feedbackValid:o,floatingClassName:k,floatingLabel:g,id:n,invalid:h,label:C,text:i,tooltipFeedback:R,valid:E},N.createElement("select",L({id:n,className:P("form-select",(r={},r["form-select-".concat(s)]=s,r["is-invalid"]=h,r["is-valid"]=E,r),b),size:j},z,{ref:d}),u?u.map(function(t,V){return N.createElement("option",L({},typeof t=="object"&&t.disabled&&{disabled:t.disabled},typeof t=="object"&&t.value!==void 0&&{value:t.value},{key:V}),typeof t=="string"?t:t.label)}):v))});F.propTypes=L({className:S.string,htmlSize:S.number,options:S.array},w.propTypes);F.displayName="CFormSelect";const ie=()=>{const{id:a}=B(),d=T(),{register:r,handleSubmit:v,setValue:b,formState:{errors:c}}=W(),[x,o]=f.useState(!1),[k,g]=f.useState([]),[j,n]=f.useState(""),h=()=>{o(!0),p.get(`http://192.168.2.9:4001/divisi/${a}`).then(s=>{if(s.data.status==="ok"){const i=s.data.data;b("nama",i.nama),b("id_lokasi",i.id_lokasi),n(i.id_lokasi)}else l.fire("Error",s.data.message,"error"),d(-1)}).catch(()=>{l.fire("Error","Oops.. Something Wrong!","error"),d(-1)}).finally(()=>o(!1))},C=()=>{p.get("http://192.168.2.9:4001/lokasi").then(s=>{s.data.status==="ok"?g(s.data.data):l.fire("Error",s.data.message,"error")}).catch(()=>{l.fire("Error","Failed to load lokasi data","error")})},u=s=>{o(!0),a?p.put(`http://192.168.2.9:4001/divisi/${a}`,s).then(i=>{l.fire("Success",i.data.message,"success"),d("/div")}).catch(()=>{l.fire("Error","Failed to update division","error")}).finally(()=>o(!1)):p.post("http://192.168.2.9:4001/divisi",s).then(i=>{l.fire("Success",i.data.message,"success"),d("/div")}).catch(()=>{l.fire("Error","Failed to create division","error")}).finally(()=>o(!1))};return f.useEffect(()=>{a&&h(),C()},[a]),e.jsxs(A,{children:[e.jsx(O,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h5",{children:a?"Edit Divisi":"Add New Divisi"}),e.jsxs(D,{color:"secondary",variant:"outline",onClick:()=>d(-1),children:[e.jsx(I,{icon:$,className:"me-2"})," Back"]})]})}),e.jsx(H,{children:e.jsxs(G,{onSubmit:v(u),children:[e.jsxs(y,{className:"mb-3",children:[e.jsx(m,{sm:2,children:e.jsx("label",{children:"Nama Divisi"})}),e.jsxs(m,{sm:8,children:[e.jsx(J,{type:"text",placeholder:"Nama Divisi",...r("nama",{required:"Nama Divisi is required"})}),c.nama&&e.jsx("span",{className:"text-danger",children:c.nama.message})]})]}),e.jsxs(y,{className:"mb-3",children:[e.jsx(m,{sm:2,children:e.jsx("label",{children:"Lokasi"})}),e.jsxs(m,{sm:8,children:[e.jsxs(F,{...r("id_lokasi",{required:"Lokasi is required"}),value:j,onChange:s=>n(s.target.value),children:[e.jsx("option",{value:"",children:"Pilih Lokasi"}),k.map(s=>e.jsx("option",{value:s.id,children:s.nama},s.id))]}),c.id_lokasi&&e.jsx("span",{className:"text-danger",children:c.id_lokasi.message})]})]}),e.jsx(y,{className:"mt-5",children:e.jsx(m,{className:"text-center",children:e.jsxs(D,{type:"submit",color:"primary",disabled:x,children:[e.jsx(I,{icon:K,className:"mx-2"})," Save"]})})})]})})]})};export{ie as default};
